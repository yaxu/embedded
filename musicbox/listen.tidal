import Sound.OSC.FD
import Control.Concurrent.MVar

do p <- newVAR silence
   let oscport = 9000
       listen = do s <- udpServer "127.0.0.1" oscport
                   oscLoop s
       oscLoop s = do m <- recvMessage s
                      act m
                      oscLoop s
       act (Just (Message "/notes" xs)) =
         do show xs
            swapMVar p $ listToPat (map (\(Int32 i) -> i) xs)
            return ()
       act _ = return ()
   

listen
