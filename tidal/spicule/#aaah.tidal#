let orb0 = (# (orbit "0"

               # delay "0.8"
               # delaytime "0.4"
               # delayfeedback "0.3"
           )
    orb1 = (# orbit "1")
    pad = (8 <~ (whenmod 16 8 (juxBy 0.5 rev) $ up (every 4 ((+ 3) <$>) $ "0 [~ 5 ~] ~ 8") # sound "pad:3")
           # end "0.15"
           # size "0.9"
           # gain "0.9")
    gab = sound "[gabba(3,8), ~ [feel:6 feel:3]]"
    gab1 = whenmod 8 4 (iter 4) $ n (run 8) # s "gabba"
           # speed "[2,1]"
           # gain "0.9"
           # orbit "1"
    bl =   runWith 4 (|*| speed "2") $ jux rev $ sound "jvbass:1(5,8)"
           # gain "1.1"
           # speed "2"
           # resonance "0.4"
           # cutoff (slow 4 $ every 4 rev $ scale 300 2000 saw1)
    funky = juxBy 0.5 rev $ chop 2 $ iter 4 $ slow 2 $ n (run 8) # s "funky"
            # speed "0.8"
            # gain "1"
            # orbit "1"
    wob = runWith 4 (density 2) $ slow 2 $ stut 8 0.7 (-0.5) $ slow 4 $ up "{[0 ~ 3] 7 [3 12] [2 5]}" # sound "wobble"
          |*| speed "[2,3,1]"
          -- # crush "5"
          # resonance "0.3"
          # cutoff (scale 1000 5000 rand)
    wyatt = whenmod 4 1 (const silence) $ (jux rev $ slowspread (\x -> zoom (0,x)) [0.5,0.25,(1/3), 0.125,1] $ chop 32 $ sound "redflag")
            # gain "0.9"
            # speed ((*2) <$> "0.9")
            # resonance "0.3"
            # cutoff (slow 4 $ every 4 rev $ scale 3000 4000 saw1)
            # vowel "a"
    bd = struct "x(3,8)" $ sound "bd"
         # room "0.9"
         # size "0.8"
         # orbit "0"
         # resonance "0.2"
         # cutoff (scale 1000 5000 rand)
    off = sound "~ [arpy,arpy:3]"
          # orbit "0"
          # resonance "0.2"
          # cutoff (scale 1000 5000 rand)
          # speed (slow 4 $ scale 0.524 0.7 $ rev saw1)
          # gain "1.3"



  
let now'' = now' - 28

do cps 1.2
   solo $ d10 $ (nextSam (now''+1)) ~>
     seqP [(0, 32, orb1 bl),
           (4,8, orb1 funky),
           (12,32, orb1 funky),
           (16,32, orb1 gab1),
           (16,17, orb1 wyatt),
           -- (32,33, orb1 wyatt),
           -- (32,64, orb1 bd),
           (32,64, orb1 $ when ((< 1) . (`mod` 16)) (const wyatt) funky),
           (32,128, orb1 wob),
           (48,128, orb1 gab1),
           (64,128, orb1 gab),
           (64,128, orb1 bl),
           (64,128, orb0 off)
          ]

d1 $ P.fadeIn 4 $ sound "bd*8"

now
-- aaah
cps 1.1



d4 $ whenmod 8 4 (iter 4) $ n (run 8) # s "gabba"
  # speed "[2,1]"
  # gain "0.9"
  # orbit "1"



d2 $ struct "x(3,8)" $ sound "bd"
  # room "0.9"
  # size "0.8"
  # orbit "0"
  # resonance "0.2"
  # cutoff (scale 1000 5000 rand)

d3 $ sound "~ [arpy,arpy:3]"
  # orbit "0"
  # delay "0.8"
  # delaytime "0.4"
  # delayfeedback "0.3"
  # resonance "0.2"
  # cutoff (scale 1000 5000 rand)
  # speed (slow 4 $ scale 0.524 0.7 $ rev saw1)
  # gain "1.1"

