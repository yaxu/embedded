(myk,_) <- superDirtSetters getNow

myk $ slow 2 $ sound "casio casio:1 casio:1 casio:1"
  # orbit 4


import Sound.Tidal.OscStream

let mykShape :: Shape
    mykShape = Shape {params = [ s_p ],
                      cpsStamp = False,
                      latency = 0
                     }
    mykSlang = OscSlang {
      path = "/fx",
      timestamp = NoStamp,
      namedParams = True,
      preamble = []
    }
    (grunge, grunge_p) = pF "grunge" Nothing
    (glass, glass_p) = pF "glass" Nothing
    (flanger, flanger_p) = pF "flanger" Nothing
    mykb = do s <- makeConnection "192.168.7.2" 57120 mykSlang
              return $ Backend s (\_ _ _ -> return ())

bb <- mykb
bb2 <- stream bb mykShape

bb2 $ grunge 0.
